<div class="row">
    <div class="col-md-12">
        <mat-card>
            <mat-card-header>
                <mat-card-title>{{ 'COMMON.META' | translate }}</mat-card-title>
            </mat-card-header>
            <mat-card-content>
                <div [formGroup]="metaForm">
                    <div formArrayName="metafields">
                        <div *ngFor="let alias of metafields.controls; let i=index" class="form-group">
                            <div [formGroupName]="i">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label>Key</label>
                                            <input type="text" fullWidth formControlName="key" class="form-control">
                                        </div>
                                    </div>
                                    <div class="col-md-5">
                                        <div class="form-group">
                                            <label>Value</label>
                                            <input *ngIf="!listItems[metafields.controls[i].value.key]; else scopeSelect" type="text"
                                                fullWidth formControlName="value" class="form-control">
                                            <ng-template #scopeSelect>
                                                <mat-form-field class="full-width">
                                                    <mat-select 
                                                        style="text-transform:capitalize" 
                                                        (selectionChange)="selectionChanged($event.value, metafields.controls[i].value.key)" 
                                                        [(value)]="meta[metafields.controls[i].value.key]">
                                                        <mat-option *ngFor="let item of listItems[metafields.controls[i].value.key]" [value]="item">
                                                            {{ item }} 
                                                        </mat-option>
                                                    </mat-select>
                                                </mat-form-field>
                                            </ng-template>
                                        </div>
                                    </div>
                                    <div class="col-md-1">
                                        <button mat-icon-button color="warn" (click)="deleteItem(i)">
                                            <mat-icon>close</mat-icon>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <button type="button" mat-raised-button color="accent" (click)="addMetaField()">
                            {{ 'COMMON.META_ADD' | translate }}
                        </button>
                    </div>
                </div>
            </mat-card-content>
        </mat-card>
    </div>
</div>
